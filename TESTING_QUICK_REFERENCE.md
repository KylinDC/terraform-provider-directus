# E2E Testing - Quick Reference

## ğŸš€ Quick Start
```bash
make e2e-setup              # Fresh environment setup
make test-e2e-comprehensive # Run all E2E tests
```

## ğŸ“‹ Common Commands

### Daily Development
```bash
make docker-up              # Start services (once per day)
make test-unit             # Quick unit tests
make test-e2e-quick        # E2E without restart
make docker-logs           # Debug failures
make docker-down           # Stop at end of day
```

### Before Commit
```bash
make all                   # Format + lint + build + unit tests
make test-e2e-comprehensive # Full E2E validation
```

### Troubleshooting
```bash
make docker-status         # Check health
make docker-wait           # Wait for ready
make docker-clean          # Nuclear option (fresh start)
make e2e-setup            # Complete reset + setup
```

## ğŸ“Š Available Targets

**Testing:**
- `make test` - Unit tests (default)
- `make test-unit` - Unit tests only
- `make test-e2e` - Basic E2E tests
- `make test-e2e-comprehensive` - Full E2E suite â­
- `make test-e2e-quick` - Fast E2E (no restart)
- `make test-all` - Unit + E2E tests

**Docker:**
- `make docker-up` - Start + wait for health
- `make docker-wait` - Wait for services
- `make docker-down` - Stop (keep data)
- `make docker-clean` - Stop + delete data
- `make docker-status` - Check status
- `make docker-logs` - View logs

**Setup:**
- `make setup` - Create .env with token
- `make e2e-setup` - Fresh environment â­

**Build:**
- `make build` - Build provider
- `make install` - Install locally
- `make fmt` - Format code
- `make lint` - Run linter
- `make deps` - Update dependencies

**Combined:**
- `make all` - fmt + lint + build + test-unit
- `make ci` - Full CI pipeline (no E2E)

## âš¡ Performance Tips

| Scenario | Command | Time |
|----------|---------|------|
| Quick iteration | `make test-unit` | ~3s |
| With E2E (running) | `make test-e2e-quick` | ~30s |
| Full validation | `make test-all` | ~2min |
| Fresh start | `make e2e-setup` | ~1min |

## ğŸ”§ Health Check Status

After `make docker-up`, you'll see:
```
[15/60] PostgreSQL: healthy | Directus: healthy
âœ“ All services are healthy!
```

Possible statuses:
- `not running` - Container not started
- `starting` - Container starting
- `healthy` - Ready for tests âœ…
- `unhealthy` - Failed health checks âŒ

## ğŸ› Common Issues

| Problem | Solution |
|---------|----------|
| Port already in use | `lsof -i :8055` then kill process |
| Services won't start | `make docker-clean && make docker-up` |
| Tests fail "connection refused" | `make docker-wait` |
| Tests fail "unauthorized" | `make setup` |
| Slow health checks | Wait 30-60s, services need time |

## ğŸ“ Files

- `Makefile` - All commands
- `docker-compose.yml` - Service config
- `.env` - Generated by `make setup` (gitignored)
- `scripts/test-e2e-comprehensive.sh` - E2E test script

## ğŸ’¡ Pro Tips

1. Keep services running during development:
   ```bash
   make docker-up       # Morning
   # ... work all day ...
   make docker-down     # Evening
   ```

2. Fast feedback loop:
   ```bash
   make test-unit       # After each change (3s)
   make test-e2e-quick  # Before commit (30s)
   ```

3. Use tab completion:
   ```bash
   make <TAB><TAB>      # See all targets
   ```

## ğŸ¯ Coverage

Current test coverage:
- Client: **73.1%** âœ…
- Provider: **14.6%** âš ï¸

See full guide: [E2E_TESTING_GUIDE.md](E2E_TESTING_GUIDE.md)
